<?xml version="1.0" encoding="UTF-8"?>
<ConfigurationExtension xmlns="http://v8.1c.ru/8.2/configuration-extension">
  <Properties>
    <Property name="Имя">РасширениеРеализации</Property>
    <Property name="Синоним">Расширение для документа Реализация</Property>
    <Property name="Комментарий">Добавляет функциональность для инвалидации кэша</Property>
  </Properties>
  
  <!-- Добавляем новое событие в документ Реализация -->
  <ObjectExtensions>
    <ObjectExtension object="Document.Реализация">
      
      <!-- Дополнительные реквизиты (не изменяя исходный объект) -->
      <Properties>
        <Property name="Реквизиты">
          <Requisite name="ФлагИнвалидацииКэша" type="Boolean">
            <Properties>
              <Property name="Имя">ФлагИнвалидацииКэша</Property>
              <Property name="Синоним">Инвалидировать кэш</Property>
              <Property name="ЗначениеПоУмолчанию">true</Property>
            </Properties>
          </Requisite>
        </Property>
      </Properties>
      
      <!-- Дополнительный код в модуле объекта -->
      <Method name="ПослеЗаписи">
        &НаСервере
        // Вызываем инвалидацию кэша после записи документа
        Если Объект.ФлагИнвалидацииКэша Тогда
          РаботаСКэшем.ИнвалидироватьКэшПриИзмененииПродаж(Объект.Дата);
        КонецЕсли;
      </Method>
      
      <!-- Добавляем обработчик на форму -->
      <Method name="ПриОткрытииНаСервере">
        &НаСервере
        // Инициализация нового реквизита на форме
        ЭлементыФормы.ФлагИнвалидацииКэша.Значение = Истина;
      </Method>
      
    </ObjectExtension>
  </ObjectExtensions>
  
  <!-- Дополнительные права доступа -->
  <RoleExtensions>
    <RoleExtension role="ПолныеПрава">
      <Rights>
        <Right object="Document.Реализация" access="ПолныеПрава"/>
      </Rights>
    </RoleExtension>
  </RoleExtensions>
</ConfigurationExtension>
