// Измерение времени выполнения
Функция ИзмеритьВремя(Действие, Параметры = Неопределено) Экспорт
    Начало = ТД();
    Попытка
        Если Параметры = Неопределено Тогда
            Результат = Действие();
        Иначе
            Результат = Действие(Параметры);
        КонецЕсли;
        Конец = ТД();
        Возврат Новый Структура("Время,Успешно,Результат", Конец-Начало, Истина, Результат);
    Исключение
        Возврат Новый Структура("Время,Успешно,Ошибка", ТД()-Начало, Ложь, ОписаниеОшибки());
    КонецПопытки;
КонецФункции

// Форматирование результатов
Функция ФорматРезультатов(Данные) Экспорт
    Если Данные.Количество() = 0 Тогда Возврат "Нет данных"; КонецЕсли;
    Результат = "ТОП-10 товаров:
    |№ | Товар | Продано | Сумма";
    Для i = 0 По Мин(9, Данные.Количество()-1) Цикл
        Стр = Данные[i];
        Результат = Результат + "
        |" + (i+1) + " | " + Стр.Наименование + " | " + 
            Формат(Стр.Продано, "ЧГ=0") + " | " + 
            Формат(Стр.Сумма, "ЧДЦ=2");
    КонецЦикла;
    Возврат Результат;
КонецФункции
